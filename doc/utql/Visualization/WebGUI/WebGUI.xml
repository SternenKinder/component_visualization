<?xml version="1.0" encoding="UTF-8"?>

<UTQLPatternTemplates xmlns='http://ar.in.tum.de/ubitrack/utql'
                      xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
                      xmlns:xi='http://www.w3.org/2001/XInclude'
                      xmlns:h="http://www.w3.org/1999/xhtml"
                      xsi:schemaLocation='http://ar.in.tum.de/ubitrack/utql ../../../schema/utql_templates.xsd'>
    
    <Pattern name="WebGuiMeasurementPose" displayName="Web GUI Measurement (Pose)">
        <Description>
            <h:p>Measurement pattern for the WebGUI lightweight web frontend.
        This pattern is associated with a visualization of the avaiability status of the associated <h:code>Push Measurement Input</h:code>.
        Use the <h:code>WebGUI Client</h:code> to associate various events (to be displayed on one WebGui client) to the same WebGUI server.
                <h:br/>
        This pattern is particularly useful for registration tasks and is probably being used in conjunction with
        the <h:code>Web GUI Event</h:code> pattern.
            </h:p>
        </Description>
        <Input>
            <!--Node name="WebGui" displayName="WebGUI Client">
                <Description>
                </Description>
            </Node-->
            <Node name="A" displayName="A"/>
            <Node name="B" displayName="B"/>
            <Edge name="Input" source="A" destination="B" displayName="Push Measurement Input">
                <Description>
                    <h:p>Measurement affecting the availability status in the web frontend</h:p>
                </Description>
                <Predicate>type=='6D'&amp;&amp;mode=='push'</Predicate>
            </Edge>
        </Input>
        <Output>
            <Node name="WebGui" displayName="WebGui Server Configuration">
                <Attribute name="port" displayName="WebGUI TCP port" min="1" max="65535" default="8080" xsi:type="IntAttributeDeclarationType">
                    <Description>
                        <h:p>TCP port the WebGUI server module is listening on
                            Unify this node with all other <h:code>WebGUI Client</h:code> nodes that are served by the same WebGUI server.
                        </h:p>
                    </Description>
                </Attribute>
            </Node>
        </Output>
        <DataflowConfiguration>
            <UbitrackLib class="WebGuiPose"/>
            <Attribute name="measurementName" displayName="Measurement Name" xsi:type="StringAttributeDeclarationType">
                <Description>
                    <h:p>Name of this measurement in the web frontend.</h:p>
                </Description>
            </Attribute>
            <Attribute name="timeout" displayName="Timeout" min="1" default="500" xsi:type="IntAttributeDeclarationType">
                <Description>
                    <h:p>Timeout in [ms] after which measurement will be declared unavailable. </h:p>
                </Description>
            </Attribute>
        </DataflowConfiguration>
    </Pattern>

    <Pattern name="WebGuiMeasurementPosition" displayName="Web GUI Measurement (Position)">
        <Description>
            <h:p>Measurement pattern for the WebGUI lightweight web frontend.
        This pattern is associated with a visualization of the avaiability status of the associated <h:code>Push Measurement Input</h:code>.
        Use the <h:code>WebGUI Client</h:code> to associate various events (to be displayed on one WebGui client) to the same WebGUI server.
                <h:br/>
        This pattern is particularly useful for registration tasks and is probably being used in conjunction with
        the <h:code>Web GUI Event</h:code> pattern.
            </h:p>
        </Description>
        <Input>
            <!--Node name="WebGui" displayName="WebGUI Client">
                <Description>
                </Description>
            </Node-->
            <Node name="A" displayName="A"/>
            <Node name="B" displayName="B"/>
            <Edge name="Input" source="A" destination="B" displayName="Push Measurement Input">
                <Description>
                    <h:p>Measurement affecting the availability status in the web frontend</h:p>
                </Description>
                <Predicate>type=='3DPosition'&amp;&amp;mode=='push'</Predicate>
            </Edge>
        </Input>
        <Output>
            <Node name="WebGui" displayName="WebGui Server Configuration">
                <Attribute name="port" displayName="WebGUI TCP port" min="1" max="65535" default="8080" xsi:type="IntAttributeDeclarationType">
                    <Description>
                        <h:p>TCP port the WebGUI server module is listening on
                            Unify this node with all other <h:code>WebGUI Client</h:code> nodes that are served by the same WebGUI server.
                        </h:p>
                    </Description>
                </Attribute>
            </Node>
        </Output>
        <DataflowConfiguration>
            <UbitrackLib class="WebGuiPosition"/>
            <Attribute name="measurementName" displayName="Measurement Name" xsi:type="StringAttributeDeclarationType">
                <Description>
                    <h:p>Name of this measurement in the web frontend.</h:p>
                </Description>
            </Attribute>
            <Attribute name="timeout" displayName="Timeout" min="1" default="500" xsi:type="IntAttributeDeclarationType">
                <Description>
                    <h:p>Timeout in [ms] after which measurement will be declared unavailable. </h:p>
                </Description>
            </Attribute>
        </DataflowConfiguration>
    </Pattern>

    <Pattern name="WebGuiMeasurementErrorPosition" displayName="Web GUI Measurement (ErrorPosition)">
        <Description>
            <h:p>Measurement pattern for the WebGUI lightweight web frontend.
        This pattern is associated with a visualization of the avaiability status of the associated <h:code>Push Measurement Input</h:code>.
        Use the <h:code>WebGUI Client</h:code> to associate various events (to be displayed on one WebGui client) to the same WebGUI server.
                <h:br/>
        This pattern is particularly useful for registration tasks and is probably being used in conjunction with
        the <h:code>Web GUI Event</h:code> pattern.
            </h:p>
        </Description>
        <Input>
            <!--Node name="WebGui" displayName="WebGUI Client">
                <Description>
                </Description>
            </Node-->
            <Node name="A" displayName="A"/>
            <Node name="B" displayName="B"/>
            <Edge name="Input" source="A" destination="B" displayName="Push Measurement Input">
                <Description>
                    <h:p>Measurement affecting the availability status in the web frontend</h:p>
                </Description>
                <Predicate>type=='3DPositionError'&amp;&amp;mode=='push'</Predicate>
            </Edge>
        </Input>
        <Output>
            <Node name="WebGui" displayName="WebGui Server Configuration">
                <Attribute name="port" displayName="WebGUI TCP port" min="1" max="65535" default="8080" xsi:type="IntAttributeDeclarationType">
                    <Description>
                        <h:p>TCP port the WebGUI server module is listening on
                            Unify this node with all other <h:code>WebGUI Client</h:code> nodes that are served by the same WebGUI server.
                        </h:p>
                    </Description>
                </Attribute>
            </Node>
        </Output>
        <DataflowConfiguration>
            <UbitrackLib class="WebGuiErrorPosition"/>
            <Attribute name="measurementName" displayName="Measurement Name" xsi:type="StringAttributeDeclarationType">
                <Description>
                    <h:p>Name of this measurement in the web frontend.</h:p>
                </Description>
            </Attribute>
            <Attribute name="timeout" displayName="Timeout" min="1" default="500" xsi:type="IntAttributeDeclarationType">
                <Description>
                    <h:p>Timeout in [ms] after which measurement will be declared unavailable. </h:p>
                </Description>
            </Attribute>
        </DataflowConfiguration>
    </Pattern>

    <Pattern name="WebGuiEvent" displayName="Web GUI Event">
        <Description>
            <p xmlns="http://www.w3.org/1999/xhtml">Event pattern for the WebGUI lightweight web frontend.
        This pattern is associated with a button in the frontend which enables the user to inject events into the dataflow.
        Use the <h:code>WebGUI Client</h:code> to associate various events (to be displayed on one WebGui client) to the same WebGUI server.
                <h:br/>
        This pattern is particularly useful for registration tasks and is probably being used in conjunction with
        the  <h:code>Web GUI Measurement</h:code> pattern.
            </p>
        </Description>
        <Output>
            <Node name="A" displayName="A"/>
            <Node name="B" displayName="B"/>
            <Node name="WebGui" displayName="WebGui Server Configuration">
                <Attribute name="port" displayName="WebGUI TCP port" min="1" max="65535" default="8080" xsi:type="IntAttributeDeclarationType">
                    <Description>
                        <h:p>TCP port the WebGUI server module is listening on
                            Unify this node with all other <h:code>WebGUI Client</h:code> nodes that are served by the same WebGUI server.
                        </h:p>
                    </Description>
                </Attribute>
            </Node>
            <Edge name="Output" source="A" destination="B" displayName="User-Generated Event">
                <Description>
                    <h:p>User-generated event issued via web frontend</h:p>
                </Description>
                <Attribute name="type" value="Button" xsi:type="EnumAttributeReferenceType"/>
                <Attribute name="mode" value="push" xsi:type="EnumAttributeReferenceType"/>
            </Edge>
        </Output>
        <DataflowConfiguration>
            <UbitrackLib class="WebGuiEvent"/>
            <Attribute name="name" displayName="Button Name" xsi:type="StringAttributeDeclarationType">
                <Description>
                    <h:p>Name of this button in the web frontend.</h:p>
                </Description>
            </Attribute>
            <Attribute name="event" displayName="Button" xsi:type="StringAttributeReferenceType">
                <Description><h:p>The button event (keycode), defaults to the space bar.</h:p></Description>
            </Attribute>
        </DataflowConfiguration>
    </Pattern>
    
    <!-- Attribute declarations -->
    
    <GlobalNodeAttributeDeclarations>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/1/1)"/>
    </GlobalNodeAttributeDeclarations>
    
    <GlobalEdgeAttributeDeclarations>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/2/1)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/2/2)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/2/3)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/2/4)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/2/5)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/2/6)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/2/7)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/2/8)"/>
    </GlobalEdgeAttributeDeclarations>

    <GlobalDataflowAttributeDeclarations>
        <!-- Unfortunately, the xpointer used in Xinclude is currently restricted to the element scheme and absolute element indices in Xerces (and thus XMLBeans) -->
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/3/1)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/3/2)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/3/3)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/3/4)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/3/5)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/3/6)"/>
        <xi:include href="file:GlobalAttrSpec.xml" xpointer="element(/1/3/7)"/>
    </GlobalDataflowAttributeDeclarations>
    
</UTQLPatternTemplates>
